<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Счет № {{ invoice_number }}</title>
    <style>
        @page {
            size: A4 portrait;
            margin: 1.5cm 1cm 1cm 1cm;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'DejaVu Sans', Arial, sans-serif;
            font-size: 9pt;
            color: #222;
            margin: 0;
            padding: 0;
            line-height: 1.4;
        }

        /* Header with logo */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 3px solid #005BAA;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .logo-img {
            height: 60px;
            width: auto;
        }

        .header-contact {
            text-align: right;
            font-size: 9pt;
            color: #333;
        }

        /* Bank details section */
        .bank-section {
            margin-bottom: 15px;
        }

        .bank-title {
            font-size: 9pt;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
            padding-bottom: 3px;
            border-bottom: 1px solid #ddd;
        }

        .bank-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 8pt;
        }

        .bank-table td {
            border: 1px solid #ccc;
            padding: 4px 6px;
            vertical-align: top;
        }

        .bank-table .label {
            background: #f5f5f5;
            color: #555;
            width: 15%;
            font-size: 7pt;
        }

        .bank-table .value {
            font-weight: 500;
        }

        /* Invoice title */
        .invoice-title {
            text-align: center;
            margin: 20px 0 15px 0;
        }

        .invoice-title h1 {
            font-size: 14pt;
            font-weight: bold;
            color: #005BAA;
            margin: 0 0 5px 0;
        }

        .invoice-title .valid-until {
            font-size: 9pt;
            color: #666;
            margin-top: 3px;
        }

        /* Parties section */
        .parties-section {
            margin-bottom: 15px;
        }

        .party-row {
            margin-bottom: 8px;
        }

        .party-label {
            font-weight: bold;
            color: #005BAA;
            margin-bottom: 3px;
        }

        .party-value {
            font-size: 8pt;
            margin-left: 0;
        }

        /* Products table */
        .products-section {
            margin-bottom: 15px;
        }

        .currency-label {
            text-align: right;
            font-size: 8pt;
            color: #555;
            margin-bottom: 5px;
        }

        .products-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 8pt;
        }

        .products-table th {
            background: #005BAA;
            color: white;
            padding: 6px 4px;
            text-align: center;
            font-weight: bold;
            font-size: 7.5pt;
            border: 1px solid #005BAA;
        }

        .products-table td {
            border: 1px solid #ddd;
            padding: 5px 4px;
            vertical-align: top;
        }

        .products-table tbody tr:nth-child(even) {
            background: #f9f9f9;
        }

        .products-table .col-no {
            width: 4%;
            text-align: center;
        }

        .products-table .col-name {
            width: 46%;
        }

        .products-table .col-qty {
            width: 8%;
            text-align: center;
        }

        .products-table .col-unit {
            width: 7%;
            text-align: center;
        }

        .products-table .col-price {
            width: 17%;
            text-align: right;
        }

        .products-table .col-amount {
            width: 18%;
            text-align: right;
        }

        /* Totals section */
        .totals-section {
            display: flex;
            justify-content: flex-end;
            margin-bottom: 15px;
        }

        .totals-table {
            width: 280px;
            border-collapse: collapse;
            font-size: 9pt;
        }

        .totals-table td {
            padding: 5px 8px;
            border-bottom: 1px solid #eee;
        }

        .totals-table .label {
            text-align: right;
        }

        .totals-table .value {
            text-align: right;
            font-weight: 500;
            width: 120px;
        }

        .totals-table .total-row td {
            border-top: 2px solid #005BAA;
            border-bottom: 2px solid #005BAA;
            font-weight: bold;
            font-size: 10pt;
            padding: 8px;
        }

        .totals-table .total-row .value {
            color: #005BAA;
        }

        /* Amount in words */
        .amount-words {
            font-size: 9pt;
            margin-bottom: 15px;
            padding: 8px 10px;
            background: #f5f5f5;
            border-radius: 4px;
        }

        .amount-words strong {
            color: #005BAA;
        }

        /* Terms section */
        .terms-section {
            font-size: 8pt;
            margin-bottom: 20px;
            padding: 10px;
            background: #fafafa;
            border-left: 3px solid #005BAA;
        }

        .terms-section p {
            margin: 4px 0;
        }

        .terms-section strong {
            color: #333;
        }

        /* Signature section */
        .signature-section {
            margin-top: 40px;
        }

        .signature-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .signature-title {
            font-weight: bold;
        }

        .signature-name {
            font-weight: bold;
            white-space: nowrap;
        }

        /* Footer contact */
        .footer-contact {
            margin-top: 25px;
            padding-top: 10px;
            border-top: 1px solid #eee;
            font-size: 8pt;
            color: #666;
        }

        .footer-contact strong {
            color: #005BAA;
        }
    </style>
</head>
<body>
    <!-- Header with Logo -->
    <div class="header">
        <div class="logo-section">
            <img src="{{ logo_path }}" alt="Master Bearing" class="logo-img">
        </div>
        <div class="header-contact">
            8 (800) 350-21-34<br>
            masterbearing.ru
        </div>
    </div>

    <!-- Bank Details Section -->
    <div class="bank-section">
        <div class="bank-title">Образец заполнения платежного поручения:</div>
        <table class="bank-table">
            <tr>
                <td rowspan="2" style="width: 50%;">
                    <span style="font-size: 7pt; color: #666;">Банк получателя</span><br>
                    <strong>АО "Кредит Европа Банк (Россия)"</strong>
                </td>
                <td class="label">БИК</td>
                <td class="value">044525767</td>
            </tr>
            <tr>
                <td class="label">Сч. №</td>
                <td class="value">30101810945250000767</td>
            </tr>
            <tr>
                <td>
                    <span style="font-size: 7pt; color: #666;">Получатель</span><br>
                    <span style="font-size: 7pt; color: #666;">ИНН {{ seller_inn }}</span>
                    <span style="font-size: 7pt; color: #666; margin-left: 15px;">КПП {{ seller_kpp }}</span><br>
                    <strong>{{ seller_company }}</strong>
                </td>
                <td class="label">Сч. №</td>
                <td class="value">40702978700903800004</td>
            </tr>
        </table>
    </div>

    <!-- Invoice Title -->
    <div class="invoice-title">
        <h1>Счет № {{ invoice_number }} от {{ invoice_date }}</h1>
        {% if valid_until %}
        <div class="valid-until">Действителен до: {{ valid_until }}</div>
        {% endif %}
    </div>

    <!-- Parties -->
    <div class="parties-section">
        <div class="party-row">
            <div class="party-label">Поставщик:</div>
            <div class="party-value">
                <strong>{{ seller_company }}</strong>, ИНН {{ seller_inn }}, КПП {{ seller_kpp }}, {{ seller_address }}
            </div>
        </div>
        <div class="party-row">
            <div class="party-label">Покупатель:</div>
            <div class="party-value">
                <strong>{{ customer_name }}</strong>{% if customer_inn %}, ИНН {{ customer_inn }}{% endif %}{% if customer_kpp %}, КПП {{ customer_kpp }}{% endif %}{% if customer_address %}, {{ customer_address }}{% endif %}{% if customer_phone %}, тел.: {{ customer_phone }}{% endif %}
            </div>
        </div>
    </div>

    <!-- Products Table -->
    <div class="products-section">
        <div class="currency-label">Валюта: <strong>{{ currency_code }}</strong></div>
        <table class="products-table">
            <thead>
                <tr>
                    <th class="col-no">№</th>
                    <th class="col-name">Наименование товара</th>
                    <th class="col-qty">Кол-во</th>
                    <th class="col-unit">Ед.изм</th>
                    <th class="col-price">Цена без НДС, {{ currency_symbol }}</th>
                    <th class="col-amount">Сумма без НДС, {{ currency_symbol }}</th>
                </tr>
            </thead>
            <tbody>
                {% for item in items %}
                <tr>
                    <td class="col-no">{{ loop.index }}</td>
                    <td class="col-name">{{ item.product_name }}</td>
                    <td class="col-qty">{{ item.quantity }}</td>
                    <td class="col-unit">шт.</td>
                    <td class="col-price">{{ item.price_no_vat }}</td>
                    <td class="col-amount">{{ item.amount_no_vat }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Totals -->
    <div class="totals-section">
        <table class="totals-table">
            <tr>
                <td class="label">Итого:</td>
                <td class="value">{{ subtotal }}</td>
            </tr>
            <tr>
                <td class="label">НДС ({{ vat_rate }}%):</td>
                <td class="value">{{ vat_amount }}</td>
            </tr>
            <tr class="total-row">
                <td class="label">Итого с НДС:</td>
                <td class="value">{{ total_with_vat }}</td>
            </tr>
        </table>
    </div>

    <!-- Amount in Words -->
    <div class="amount-words">
        Всего наименований <strong>{{ items_count }}</strong>, на сумму: <strong>{{ total_in_words }}</strong>
    </div>

    <!-- Terms -->
    <div class="terms-section">
        <p><strong>Условия оплаты:</strong> {{ payment_terms }}</p>
        <p><strong>Срок поставки:</strong> {{ delivery_time }} календарных дней с даты зачисления аванса</p>
        <p><strong>Цена включает:</strong> {{ price_includes }}</p>
    </div>

    <!-- Signature -->
    <div class="signature-section">
        <div class="signature-row">
            <span class="signature-title">{{ ceo_title }}</span>
            <span class="signature-name">{{ ceo_name }}</span>
        </div>
    </div>

    <!-- Footer Contact -->
    {% if manager_name or manager_phone %}
    <div class="footer-contact">
        <strong>По вопросам обращаться:</strong> {{ manager_name }}{% if manager_phone %}, тел.: {{ manager_phone }}{% endif %}{% if manager_email %}, {{ manager_email }}{% endif %}
    </div>
    {% endif %}
</body>
</html>
